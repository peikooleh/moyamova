/* ==========================================================
 * –ü—Ä–æ–µ–∫—Ç: MOYAMOVA
 * –§–∞–π–ª: view.guide.js
 * –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ: –≠–∫—Ä–∞–Ω –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏/–≥–∞–π–¥–∞
 * –í–µ—Ä—Å–∏—è: 1.0
 * –û–±–Ω–æ–≤–ª–µ–Ω–æ: 2025-11-17
 * ========================================================== */

(function (root) {
  'use strict';

  let sheet, scroller, styleTag;
  let swX0 = 0, swY0 = 0, swMoved = false;

  // -------------------------
  // LANG
  // -------------------------
  function currentLang() {
    try {
      const dom = document.documentElement.getAttribute('lang');
      const app = (root.App && App.settings && (App.settings.uiLang || App.settings.lang));
      const raw = String(dom || app || 'ru').toLowerCase();
      if (raw === 'uk' || raw === 'ua' || raw.startsWith('uk-')) return 'uk';
      return 'ru';
    } catch (_) {
      return 'ru';
    }
  }

  // -------------------------
  // TEXTS (RU / UK)
  // -------------------------
  function strings() {
    const RU = {
      title: '–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è',
      blocks: [
        {
          h: '–ß—Ç–æ —Ç–∞–∫–æ–µ MOYAMOVA',
          p: [
            'MOYAMOVA ‚Äî —ç—Ç–æ –æ—Ñ–ª–∞–π–Ω-—Ç—Ä–µ–Ω–∞–∂—ë—Ä –¥–ª—è –∏–∑—É—á–µ–Ω–∏—è —Å–ª–æ–≤ —á–µ—Ä–µ–∑ –∫–∞—Ä—Ç–æ—á–∫–∏. –í –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –Ω–µ—Ç —Ä–µ–∫–ª–∞–º—ã, –ø–æ–¥–ø–∏—Å–æ–∫ –∏ –ª–∏—à–Ω–µ–≥–æ —à—É–º–∞ ‚Äî —Ç–æ–ª—å–∫–æ —Å–ª–æ–≤–∞, –≤–∞—à —Ñ–æ–∫—É—Å –∏ –ø—Ä–æ–≥—Ä–µ—Å—Å.',
            'MOYAMOVA —Ä–∞–±–æ—Ç–∞–µ—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é –ª–æ–∫–∞–ª—å–Ω–æ: –≤—Å–µ –¥–∞–Ω–Ω—ã–µ —Ö—Ä–∞–Ω—è—Ç—Å—è —Ç–æ–ª—å–∫–æ –Ω–∞ –≤–∞—à–µ–º —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ.'
          ]
        },
        {
          h: '–ö–∞–∫ —É—Å—Ç—Ä–æ–µ–Ω–∞ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞',
          p: [
            '–°–ª–æ–≤–∞ –≤ —Å–ª–æ–≤–∞—Ä—è—Ö —Ä–∞–∑–±–∏—Ç—ã –Ω–∞ —Å–µ—Ç—ã ‚Äî –Ω–µ–±–æ–ª—å—à–∏–µ –ø–æ—Ä—Ü–∏–∏ —Å–ª–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ —É–¥–æ–±–Ω–æ –ø—Ä–æ—Ö–æ–¥–∏—Ç—å –∑–∞ –æ–¥–∏–Ω –ø–æ–¥—Ö–æ–¥.',
            '1) –í—ã –≤—ã–±–∏—Ä–∞–µ—Ç–µ —è–∑—ã–∫, —Å–ª–æ–≤–∞—Ä—å –∏ –Ω—É–∂–Ω—ã–π —Å–µ—Ç.',
            '2) –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å–ª–æ–≤–æ, –∞ –≤–∞—à–∞ –∑–∞–¥–∞—á–∞ ‚Äî –≤—ã–±—Ä–∞—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–µ—Ä–µ–≤–æ–¥.',
            '3) –ó–∞ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã —Å–ª–æ–≤–æ –ø–æ–ª—É—á–∞–µ—Ç –∑–≤—ë–∑–¥—ã.',
            '4) –ü—Ä–∏ –æ—à–∏–±–∫–∞—Ö —Å–ª–æ–≤–æ —Ç–µ—Ä—è–µ—Ç —á–∞—Å—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –∏ –ø–æ–≤—Ç–æ—Ä—è–µ—Ç—Å—è —á–∞—â–µ.',
            '5) –ö–æ–≥–¥–∞ —Å–ª–æ–≤–æ –Ω–∞–±–∏—Ä–∞–µ—Ç –º–∞–∫—Å–∏–º—É–º –∑–≤—ë–∑–¥ ‚Äî –æ–Ω–æ —Å—á–∏—Ç–∞–µ—Ç—Å—è –≤—ã—É—á–µ–Ω–Ω—ã–º –∏ –ø–µ—Ä–µ—Å—Ç–∞—ë—Ç –ø–æ–ø–∞–¥–∞—Ç—å—Å—è –≤ —ç—Ç–æ–º —Å–µ—Ç–µ.',
            '–¢–∞–∫ –≤—ã –∏–∑—É—á–∞–µ—Ç–µ –±–æ–ª—å—à–∏–µ —Å–ª–æ–≤–∞—Ä–∏ –Ω–µ–±–æ–ª—å—à–∏–º–∏ —É–¥–æ–±–Ω—ã–º–∏ –ø–æ—Ä—Ü–∏—è–º–∏.'
          ]
        },
        {
          h: '–°–∫–æ–ª—å–∫–æ –≤—Ä–µ–º–µ–Ω–∏ –∑–∞–Ω–∏–º–∞–µ—Ç –æ–¥–∏–Ω —Å–µ—Ç',
          p: [
            '–í –æ–±—ã—á–Ω–æ–º —Ä–µ–∂–∏–º–µ –æ–¥–∏–Ω —Å–µ—Ç –æ–±—ã—á–Ω–æ –∑–∞–Ω–∏–º–∞–µ—Ç –æ–∫–æ–ª–æ 5‚Äì10 –º–∏–Ω—É—Ç —Å–ø–æ–∫–æ–π–Ω–æ–π —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏.',
            '–í —Å–ª–æ–∂–Ω–æ–º —Ä–µ–∂–∏–º–µ ‚Äî –ø—Ä–∏–º–µ—Ä–Ω–æ 10‚Äì15 –º–∏–Ω—É—Ç, —Ç–∞–∫ –∫–∞–∫ —à—Ç—Ä–∞—Ñ—ã —Å—Ç—Ä–æ–∂–µ, –∞ —Å–ª–æ–≤–∞ –¥–æ–ª—å—à–µ –æ—Å—Ç–∞—é—Ç—Å—è –≤ —Ä–æ—Ç–∞—Ü–∏–∏.',
            '–û–ø—Ç–∏–º–∞–ª—å–Ω–æ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∞—Ç—å—Å—è –∫–æ—Ä–æ—Ç–∫–∏–º–∏ –ø–æ–¥—Ö–æ–¥–∞–º–∏ ‚Äî –º–æ–∑–≥ —Ç–∞–∫ –ª—É—á—à–µ –∑–∞–ø–æ–º–∏–Ω–∞–µ—Ç –ª–µ–∫—Å–∏–∫—É.'
          ]
        },
        {
          h: '–†–µ–∂–∏–º—ã —Å–ª–æ–∂–Ω–æ—Å—Ç–∏',
          p: [
            'üê£ –û–±—ã—á–Ω—ã–π —Ä–µ–∂–∏–º ‚Äî –º—è–≥–∫–∏–µ —à—Ç—Ä–∞—Ñ—ã –∑–∞ –æ—à–∏–±–∫–∏, –∑–≤—ë–∑–¥—ã —Ä–∞—Å—Ç—É—Ç –±—ã—Å—Ç—Ä–µ–µ. –•–æ—Ä–æ—à–æ –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –±–æ–ª—å—à–∏—Ö –æ–±—ä—ë–º–æ–≤ —Å–ª–æ–≤.',
            'ü¶Ö –°–ª–æ–∂–Ω—ã–π —Ä–µ–∂–∏–º ‚Äî —Å—Ç—Ä–æ–≥–∏–π —É—á—ë—Ç –æ—à–∏–±–æ–∫, –º–µ–¥–ª–µ–Ω–Ω—ã–π —Ä–æ—Å—Ç –∑–≤—ë–∑–¥. –°–ª–æ–≤–∞ –¥–æ–ª—å—à–µ –æ—Å—Ç–∞—é—Ç—Å—è –≤ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–µ –∏ –∑–∞–ø–æ–º–∏–Ω–∞—é—Ç—Å—è –≥–ª—É–±–∂–µ.'
          ]
        },
        {
          h: '–û—Å–Ω–æ–≤–Ω—ã–µ —Ä–∞–∑–¥–µ–ª—ã –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è',
          ul: [
            'üè† –ì–ª–∞–≤–Ω–∞—è ‚Äî —Ç–µ–∫—É—â–∏–µ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ –∏ –ø—Ä–æ–≥—Ä–µ—Å—Å –∞–∫—Ç–∏–≤–Ω–æ–≥–æ —Å–µ—Ç–∞.',
            'üìö –°–ª–æ–≤–∞—Ä–∏ ‚Äî –≤—ã–±–æ—Ä —è–∑—ã–∫–∞, —á–∞—Å—Ç–∏ —Ä–µ—á–∏, —Å–ª–æ–≤–∞—Ä—è –∏ —Å–µ—Ç–∞.',
            '‚≠ê –ò–∑–±—Ä–∞–Ω–Ω–æ–µ ‚Äî —Å–ª–æ–≤–∞, –æ—Ç–º–µ—á–µ–Ω–Ω—ã–µ —Å–µ—Ä–¥—Ü–µ–º.',
            '‚ö†Ô∏è –ú–æ–∏ –æ—à–∏–±–∫–∏ ‚Äî —Å–ª–æ–≤–∞, –≤ –∫–æ—Ç–æ—Ä—ã—Ö –≤—ã —á–∞—â–µ –≤—Å–µ–≥–æ –æ—à–∏–±–∞–ª–∏—Å—å.',
            'üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ ‚Äî –ø—Ä–æ–≥—Ä–µ—Å—Å –ø–æ —è–∑—ã–∫–∞–º, —á–∞—Å—Ç—è–º —Ä–µ—á–∏ –∏ –¥–Ω—è–º.'
          ]
        },
        {
          h: '–ú–µ–Ω—é –Ω–∞—Å—Ç—Ä–æ–µ–∫',
          ul: [
            '‚òÄÔ∏èüåô –¢–µ–º–∞ ‚Äî —Å–≤–µ—Ç–ª–∞—è –∏–ª–∏ —Ç—ë–º–Ω–∞—è.',
            'üá∑üá∫ / üá∫üá¶ –Ø–∑—ã–∫ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ ‚Äî –º–≥–Ω–æ–≤–µ–Ω–Ω–∞—è —Å–º–µ–Ω–∞ —è–∑—ã–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.',
            'üê£ / ü¶Ö –†–µ–∂–∏–º —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ ‚Äî –≤–ª–∏—è–µ—Ç –Ω–∞ –ø–æ–≤–µ–¥–µ–Ω–∏–µ —Ç—Ä–µ–Ω–∞–∂—ë—Ä–∞ –∏ —Å–∫–æ—Ä–æ—Å—Ç—å –∑–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è.',
            'üíæ –†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ ‚Äî —ç–∫—Å–ø–æ—Ä—Ç –∏ –∏–º–ø–æ—Ä—Ç –≤—Å–µ—Ö –¥–∞–Ω–Ω—ã—Ö.',
            'üîÑ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è ‚Äî —Ä—É—á–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–æ–≤–æ–π –≤–µ—Ä—Å–∏–∏.'
          ]
        },
        {
          h: '–†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –ø–µ—Ä–µ–Ω–æ—Å –ø—Ä–æ–≥—Ä–µ—Å—Å–∞',
          p: [
            '–í—Å–µ –¥–∞–Ω–Ω—ã–µ —Ö—Ä–∞–Ω—è—Ç—Å—è –ª–æ–∫–∞–ª—å–Ω–æ, –ø–æ—ç—Ç–æ–º—É —Ä–µ–∑–µ—Ä–≤–Ω–∞—è –∫–æ–ø–∏—è ‚Äî –ª—É—á—à–∏–π —Å–ø–æ—Å–æ–± –∑–∞—â–∏—Ç–∏—Ç—å —Å–≤–æ–π –ø—Ä–æ–≥—Ä–µ—Å—Å –∏–ª–∏ –ø–µ—Ä–µ–Ω–µ—Å—Ç–∏ –µ–≥–æ –Ω–∞ –¥—Ä—É–≥–æ–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ.',
            '–≠–∫—Å–ø–æ—Ä—Ç: –ú–µ–Ω—é ‚Üí ¬´–†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ¬ª ‚Üí ¬´–≠–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ¬ª. –ë—É–¥–µ—Ç —Å–æ–∑–¥–∞–Ω —Ñ–∞–π–ª moyamova-backup.json.',
            '–ò–º–ø–æ—Ä—Ç: –ú–µ–Ω—é ‚Üí ¬´–†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ¬ª ‚Üí ¬´–ò–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ¬ª –∏ –≤—ã–±–æ—Ä —Ñ–∞–π–ª–∞.',
            '–ï—Å–ª–∏ –≤ —Ñ–∞–π–ª–µ –º–µ–Ω—å—à–µ –¥–∞–Ω–Ω—ã—Ö, —á–µ–º –≤ –≤–∞—à–µ–º —Ç–µ–∫—É—â–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å–µ ‚Äî –∏–º–ø–æ—Ä—Ç –∑–∞–±–ª–æ–∫–∏—Ä—É–µ—Ç—Å—è, —á—Ç–æ–±—ã –≤—ã —Å–ª—É—á–∞–π–Ω–æ –Ω–µ –ø–æ—Ç–µ—Ä—è–ª–∏ –∏–∑—É—á–µ–Ω–Ω—ã–µ —Å–ª–æ–≤–∞ –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É.',
            '–î–ª—è –ø–µ—Ä–µ–Ω–æ—Å–∞ –Ω–∞ –Ω–æ–≤–æ–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ: —Å–¥–µ–ª–∞–π—Ç–µ —ç–∫—Å–ø–æ—Ä—Ç ‚Üí –æ—Ç–ø—Ä–∞–≤—å—Ç–µ —Ñ–∞–π–ª (—á–∞—Ç, –ø–æ—á—Ç–∞, AirDrop, –æ–±–ª–∞–∫–æ) ‚Üí –≤—ã–ø–æ–ª–Ω–∏—Ç–µ –∏–º–ø–æ—Ä—Ç –Ω–∞ –¥—Ä—É–≥–æ–º —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ.'
          ]
        },
        {
          h: '–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∫–∞–∫ PWA',
          p: [
            '–í—ã –º–æ–∂–µ—Ç–µ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å MOYAMOVA –∫–∞–∫ –æ—Ç–¥–µ–ª—å–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ.',
            'iPhone / iPad: Safari ‚Üí –∫–Ω–æ–ø–∫–∞ ¬´–ü–æ–¥–µ–ª–∏—Ç—å—Å—è¬ª ‚Üí ¬´–î–æ–±–∞–≤–∏—Ç—å –Ω–∞ —ç–∫—Ä–∞–Ω –î–æ–º–æ–π¬ª.',
            'Android: Chrome ‚Üí ¬´–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ¬ª –∏–ª–∏ ¬´–î–æ–±–∞–≤–∏—Ç—å –Ω–∞ –≥–ª–∞–≤–Ω—ã–π —ç–∫—Ä–∞–Ω¬ª.',
            '–¢–∞–∫ MOYAMOVA –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è –±—ã—Å—Ç—Ä–µ–µ –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ, –∞ –Ω–µ –≤–∫–ª–∞–¥–∫–∞ –±—Ä–∞—É–∑–µ—Ä–∞.'
          ]
        },
        {
          h: '–û–±–Ω–æ–≤–ª–µ–Ω–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è',
          p: [
            'MOYAMOVA –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è.',
            '–î–ª—è —Ä—É—á–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏ –æ—Ç–∫—Ä–æ–π—Ç–µ –º–µ–Ω—é –∏ –Ω–∞–∂–º–∏—Ç–µ ¬´–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è¬ª.',
            '–ï—Å–ª–∏ –¥–æ—Å—Ç—É–ø–Ω–∞ –Ω–æ–≤–∞—è –≤–µ—Ä—Å–∏—è, –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å–∫–∞—á–∞–µ—Ç –µ—ë –∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—Å—è.',
            '–ï—Å–ª–∏ —É –≤–∞—Å —É–∂–µ –∞–∫—Ç—É–∞–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è ‚Äî –≤—ã —É–≤–∏–¥–∏—Ç–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ.'
          ]
        },
        {
          h: '–ú–∏—Å—Å–∏—è –ø—Ä–æ–µ–∫—Ç–∞',
          p: [
            '–ú—ã —Å—Ç—Ä–µ–º–∏–º—Å—è —Å–¥–µ–ª–∞—Ç—å –∏–∑—É—á–µ–Ω–∏–µ —Å–ª–æ–≤ –ø—Ä–æ—Å—Ç—ã–º, —Å–ø–æ–∫–æ–π–Ω—ã–º –∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–º: –Ω–∏–∫–∞–∫–æ–π —Ä–µ–∫–ª–∞–º—ã, –Ω–∏–∫–∞–∫–∏—Ö –æ—Ç–≤–ª–µ–∫–∞—é—â–∏—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤ ‚Äî —Ç–æ–ª—å–∫–æ –≤—ã, —è–∑—ã–∫ –∏ –ø—Ä–∞–∫—Ç–∏–∫–∞.'
          ]
        },
        {
          h: '–°–ø–∞—Å–∏–±–æ, —á—Ç–æ –≤—ã —Å –Ω–∞–º–∏',
          p: [
            '–ï—Å–ª–∏ MOYAMOVA –ø–æ–º–æ–≥–∞–µ—Ç –≤–∞–º —É—á–∏—Ç—å—Å—è, –≤—ã –º–æ–∂–µ—Ç–µ –ø–æ–¥–¥–µ—Ä–∂–∞—Ç—å —Ä–∞–∑–≤–∏—Ç–∏–µ –ø—Ä–æ–µ–∫—Ç–∞ —á–µ—Ä–µ–∑ –ø—É–Ω–∫—Ç ¬´–ü–æ–¥–¥–µ—Ä–∂–∞—Ç—å –ø—Ä–æ–µ–∫—Ç¬ª –≤ –º–µ–Ω—é.',
            '–ö–∞–∂–¥–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ ‚Äî –≤–∫–ª–∞–¥ –≤ –Ω–æ–≤—ã–µ —Å–ª–æ–≤–∞—Ä–∏, —Ñ—É–Ω–∫—Ü–∏–∏ –∏ —Ä–∞–∑–≤–∏—Ç–∏–µ —Ç—Ä–µ–Ω–∞–∂—ë—Ä–∞ üíô'
          ]
        }
      ]
    };

    const UK = {
      title: '–Ü–Ω—Å—Ç—Ä—É–∫—Ü—ñ—è',
      blocks: [
        {
          h: '–©–æ —Ç–∞–∫–µ MOYAMOVA',
          p: [
            'MOYAMOVA ‚Äî —Ü–µ –æ—Ñ–ª–∞–π–Ω-—Ç—Ä–µ–Ω–∞–∂–µ—Ä –¥–ª—è –≤–∏–≤—á–µ–Ω–Ω—è —Å–ª—ñ–≤ –∑–∞ –∫–∞—Ä—Ç–∫–∞–º–∏. –ù—ñ—è–∫–æ—ó —Ä–µ–∫–ª–∞–º–∏, –ø—ñ–¥–ø–∏—Å–æ–∫ —á–∏ –∑–∞–π–≤–æ–≥–æ —à—É–º—É ‚Äî –ª–∏—à–µ —Å–ª–æ–≤–∞, –≤–∞—à —Ñ–æ–∫—É—Å —ñ –ø—Ä–æ–≥—Ä–µ—Å.',
            '–£—Å—ñ –¥–∞–Ω—ñ –∑–±–µ—Ä—ñ–≥–∞—é—Ç—å—Å—è —Ç—ñ–ª—å–∫–∏ –Ω–∞ –≤–∞—à–æ–º—É –ø—Ä–∏—Å—Ç—Ä–æ—ó.'
          ]
        },
        {
          h: '–Ø–∫ –≤–ª–∞—à—Ç–æ–≤–∞–Ω–µ —Ç—Ä–µ–Ω—É–≤–∞–Ω–Ω—è',
          p: [
            '–°–ª–æ–≤–∞ —É —Å–ª–æ–≤–Ω–∏–∫–∞—Ö –ø–æ–¥—ñ–ª–µ–Ω—ñ –Ω–∞ —Å–µ—Ç–∏ ‚Äî –Ω–µ–≤–µ–ª–∏–∫—ñ –ø–æ—Ä—Ü—ñ—ó —Å–ª—ñ–≤, —è–∫—ñ –∑—Ä—É—á–Ω–æ –ø—Ä–æ—Ö–æ–¥–∏—Ç–∏ –∑–∞ –æ–¥–∏–Ω –ø—ñ–¥—Ö—ñ–¥.',
            '1) –í–∏ –æ–±–∏—Ä–∞—î—Ç–µ –º–æ–≤—É, —Å–ª–æ–≤–Ω–∏–∫ —ñ –ø–æ—Ç—Ä—ñ–±–Ω–∏–π —Å–µ—Ç.',
            '2) –ó–∞—Å—Ç–æ—Å—É–Ω–æ–∫ –ø–æ–∫–∞–∑—É—î —Å–ª–æ–≤–æ, –∞ –≤–∏ –æ–±–∏—Ä–∞—î—Ç–µ –ø–µ—Ä–µ–∫–ª–∞–¥.',
            '3) –ó–∞ –ø—Ä–∞–≤–∏–ª—å–Ω—ñ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ —Å–ª–æ–≤–æ –æ—Ç—Ä–∏–º—É—î –∑—ñ—Ä–∫–∏.',
            '4) –ü–æ–º–∏–ª–∫–∏ –∑–º–µ–Ω—à—É—é—Ç—å –ø—Ä–æ–≥—Ä–µ—Å —Å–ª–æ–≤–∞ —ñ –∑–±—ñ–ª—å—à—É—é—Ç—å —á–∞—Å—Ç–æ—Ç—É –ø–æ–≤—Ç–æ—Ä–µ–Ω—å.',
            '5) –ü—ñ—Å–ª—è –º–∞–∫—Å–∏–º—É–º—É –∑—ñ—Ä–æ–∫ —Å–ª–æ–≤–æ –≤–≤–∞–∂–∞—î—Ç—å—Å—è –≤–∏–≤—á–µ–Ω–∏–º —ñ –ø–µ—Ä–µ—Å—Ç–∞—î –∑ º—è–≤–ª—è—Ç–∏—Å—è –≤ —Ü—å–æ–º—É —Å–µ—Ç—ñ.',
            '–¢–∞–∫ –≤–µ–ª–∏–∫–∏–π —Å–ª–æ–≤–Ω–∏–∫ –ø—Ä–æ—Ö–æ–¥–∏—Ç—å—Å—è –Ω–µ–≤–µ–ª–∏–∫–∏–º–∏, –∫–µ—Ä–æ–≤–∞–Ω–∏–º–∏ –∫—Ä–æ–∫–∞–º–∏.'
          ]
        },
        {
          h: '–°–∫—ñ–ª—å–∫–∏ —á–∞—Å—É –∑–∞–π–º–∞—î –æ–¥–∏–Ω —Å–µ—Ç',
          p: [
            '–£ –∑–≤–∏—á–∞–π–Ω–æ–º—É —Ä–µ–∂–∏–º—ñ –æ–¥–∏–Ω —Å–µ—Ç –∑–∞–∑–≤–∏—á–∞–π –∑–∞–π–º–∞—î –ø—Ä–∏–±–ª–∏–∑–Ω–æ 5‚Äì10 —Ö–≤–∏–ª–∏–Ω —Å–ø–æ–∫—ñ–π–Ω–æ–≥–æ —Ç—Ä–µ–Ω—É–≤–∞–Ω–Ω—è.',
            '–£ —Å–∫–ª–∞–¥–Ω–æ–º—É —Ä–µ–∂–∏–º—ñ ‚Äî –±–ª–∏–∑—å–∫–æ 10‚Äì15 —Ö–≤–∏–ª–∏–Ω, –∞–¥–∂–µ —à—Ç—Ä–∞—Ñ–∏ —Å—É–≤–æ—Ä—ñ—à—ñ, –∞ —Å–ª–æ–≤–∞ –¥–æ–≤—à–µ –∑–∞–ª–∏—à–∞—é—Ç—å—Å—è –≤ —Ä–æ—Ç–∞—Ü—ñ—ó.',
            '–ö–æ—Ä–æ—Ç–∫—ñ —Ä–µ–≥—É–ª—è—Ä–Ω—ñ –ø—ñ–¥—Ö–æ–¥–∏ ‚Äî –Ω–∞–π–µ—Ñ–µ–∫—Ç–∏–≤–Ω—ñ—à–∏–π —Å–ø–æ—Å—ñ–± –∑–∞–∫—Ä—ñ–ø–ª—é–≤–∞—Ç–∏ –ª–µ–∫—Å–∏–∫—É.'
          ]
        },
        {
          h: '–†–µ–∂–∏–º–∏ —Å–∫–ª–∞–¥–Ω–æ—Å—Ç—ñ',
          p: [
            'üê£ –ó–≤–∏—á–∞–π–Ω–∏–π —Ä–µ–∂–∏–º ‚Äî –º º—è–∫—à—ñ —à—Ç—Ä–∞—Ñ–∏ –∑–∞ –ø–æ–º–∏–ª–∫–∏, —à–≤–∏–¥—à–µ –∑—Ä–æ—Å—Ç–∞–Ω–Ω—è –∑—ñ—Ä–æ–∫. –ü—ñ–¥—Ö–æ–¥–∏—Ç—å –¥–ª—è –≤–µ–ª–∏–∫–∏—Ö –æ–±—Å—è–≥—ñ–≤ —Å–ª—ñ–≤.',
            'ü¶Ö –°–∫–ª–∞–¥–Ω–∏–π —Ä–µ–∂–∏–º ‚Äî —Å—É–≤–æ—Ä—ñ—à–∏–π –æ–±–ª—ñ–∫ –ø–æ–º–∏–ª–æ–∫, –ø–æ–≤—ñ–ª—å–Ω—ñ—à–µ –∑—Ä–æ—Å—Ç–∞–Ω–Ω—è –∑—ñ—Ä–æ–∫. –°–ª–æ–≤–∞ –∫—Ä–∞—â–µ —Ñ—ñ–∫—Å—É—é—Ç—å—Å—è –≤ –ø–∞–º º—è—Ç—ñ.'
          ]
        },
        {
          h: '–û—Å–Ω–æ–≤–Ω—ñ —Ä–æ–∑–¥—ñ–ª–∏ –∑–∞—Å—Ç–æ—Å—É–Ω–∫—É',
          ul: [
            'üè† –ì–æ–ª–æ–≤–Ω–∞ ‚Äî –ø–æ—Ç–æ—á–Ω—ñ —Ç—Ä–µ–Ω—É–≤–∞–Ω–Ω—è —ñ –ø—Ä–æ–≥—Ä–µ—Å –∞–∫—Ç–∏–≤–Ω–æ–≥–æ —Å–µ—Ç—É.',
            'üìö –°–ª–æ–≤–Ω–∏–∫–∏ ‚Äî –≤–∏–±—ñ—Ä –º–æ–≤–∏, —á–∞—Å—Ç–∏–Ω–∏ –º–æ–≤–∏, —Å–ª–æ–≤–Ω–∏–∫–∞ —ñ —Å–µ—Ç—É.',
            '‚≠ê –û–±—Ä–∞–Ω–µ ‚Äî —Å–ª–æ–≤–∞, —è–∫—ñ –≤–∏ –ø–æ–∑–Ω–∞—á–∏–ª–∏ —Å–µ—Ä–¥–µ—á–∫–æ–º.',
            '‚ö†Ô∏è –ú–æ—ó –ø–æ–º–∏–ª–∫–∏ ‚Äî —Å–ª–æ–≤–∞, —É —è–∫–∏—Ö –≤–∏ –Ω–∞–π—á–∞—Å—Ç—ñ—à–µ –ø–æ–º–∏–ª—è—î—Ç–µ—Å—å.',
            'üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ ‚Äî –ø—Ä–æ–≥—Ä–µ—Å –∑–∞ –º–æ–≤–∞–º–∏, —á–∞—Å—Ç–∏–Ω–∞–º–∏ –º–æ–≤–∏ —Ç–∞ –¥–Ω—è–º–∏.'
          ]
        },
        {
          h: '–ú–µ–Ω—é –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω—å',
          ul: [
            '‚òÄÔ∏èüåô –¢–µ–º–∞ ‚Äî —Å–≤—ñ—Ç–ª–∞ –∞–±–æ —Ç–µ–º–Ω–∞.',
            'üá∑üá∫ / üá∫üá¶ –ú–æ–≤–∞ —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å—É ‚Äî —à–≤–∏–¥–∫–µ –ø–µ—Ä–µ–º–∏–∫–∞–Ω–Ω—è –º–æ–≤–∏ –∑–∞—Å—Ç–æ—Å—É–Ω–∫—É.',
            'üê£ / ü¶Ö –†–µ–∂–∏–º —Å–∫–ª–∞–¥–Ω–æ—Å—Ç—ñ ‚Äî –≤–ø–ª–∏–≤–∞—î –Ω–∞ –ø–æ–≤–µ–¥—ñ–Ω–∫—É —Ç—Ä–µ–Ω–∞–∂–µ—Ä–∞.',
            'üíæ –†–µ–∑–µ—Ä–≤–Ω–µ –∫–æ–ø—ñ—é–≤–∞–Ω–Ω—è ‚Äî –µ–∫—Å–ø–æ—Ä—Ç —ñ —ñ–º–ø–æ—Ä—Ç —É—Å—ñ—Ö –¥–∞–Ω–∏—Ö.',
            'üîÑ –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è ‚Äî —Ä—É—á–Ω–∞ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞ –Ω–æ–≤–æ—ó –≤–µ—Ä—Å—ñ—ó.'
          ]
        },
        {
          h: '–†–µ–∑–µ—Ä–≤–Ω–µ –∫–æ–ø—ñ—é–≤–∞–Ω–Ω—è —Ç–∞ –ø–µ—Ä–µ–Ω–µ—Å–µ–Ω–Ω—è –ø—Ä–æ–≥—Ä–µ—Å—É',
          p: [
            '–†–µ–∑–µ—Ä–≤–Ω–∞ –∫–æ–ø—ñ—è ‚Äî –Ω–∞–π–∫—Ä–∞—â–∏–π —Å–ø–æ—Å—ñ–± –∑–±–µ—Ä–µ–≥—Ç–∏ –ø—Ä–æ–≥—Ä–µ—Å –∞–±–æ –ø–µ—Ä–µ–Ω–µ—Å—Ç–∏ –π–æ–≥–æ –Ω–∞ —ñ–Ω—à–∏–π –ø—Ä–∏—Å—Ç—Ä—ñ–π.',
            '–ï–∫—Å–ø–æ—Ä—Ç: –ú–µ–Ω—é ‚Üí ¬´–†–µ–∑–µ—Ä–≤–Ω–µ –∫–æ–ø—ñ—é–≤–∞–Ω–Ω—è¬ª ‚Üí ¬´–ï–∫—Å–ø–æ—Ä—Ç—É–≤–∞—Ç–∏ –¥–∞–Ω—ñ¬ª. –ë—É–¥–µ —Å—Ç–≤–æ—Ä–µ–Ω–æ —Ñ–∞–π–ª moyamova-backup.json.',
            '–Ü–º–ø–æ—Ä—Ç: –ú–µ–Ω—é ‚Üí ¬´–†–µ–∑–µ—Ä–≤–Ω–µ –∫–æ–ø—ñ—é–≤–∞–Ω–Ω—è¬ª ‚Üí ¬´–Ü–º–ø–æ—Ä—Ç—É–≤–∞—Ç–∏ –¥–∞–Ω—ñ¬ª —ñ –≤–∏–±—ñ—Ä —Ü—å–æ–≥–æ —Ñ–∞–π–ª—É.',
            '–Ø–∫—â–æ —É —Ñ–∞–π–ª—ñ –º–µ–Ω—à–µ –¥–∞–Ω–∏—Ö, –Ω—ñ–∂ —É –≤–∞—à–æ–º—É –ø–æ—Ç–æ—á–Ω–æ–º—É –ø—Ä–æ–≥—Ä–µ—Å—ñ, —ñ–º–ø–æ—Ä—Ç –±—É–¥–µ –∑–∞–±–ª–æ–∫–æ–≤–∞–Ω–æ, —â–æ–± –≤–∏ –≤–∏–ø–∞–¥–∫–æ–≤–æ –Ω–µ –≤—Ç—Ä–∞—Ç–∏–ª–∏ –≤–∏–≤—á–µ–Ω—ñ —Å–ª–æ–≤–∞.',
            '–©–æ–± –ø–µ—Ä–µ–Ω–µ—Å—Ç–∏ –ø—Ä–æ–≥—Ä–µ—Å: –∑—Ä–æ–±—ñ—Ç—å –µ–∫—Å–ø–æ—Ä—Ç ‚Üí –Ω–∞–¥—ñ—à–ª—ñ—Ç—å —Ñ–∞–π–ª –Ω–∞ –Ω–æ–≤–∏–π –ø—Ä–∏—Å—Ç—Ä—ñ–π ‚Üí –≤–∏–∫–æ–Ω–∞–π—Ç–µ —ñ–º–ø–æ—Ä—Ç.'
          ]
        },
        {
          h: '–í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è —è–∫ PWA',
          p: [
            'MOYAMOVA –º–æ–∂–Ω–∞ –≤—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ —è–∫ –æ–∫—Ä–µ–º–∏–π –∑–∞—Å—Ç–æ—Å—É–Ω–æ–∫.',
            'iPhone / iPad: Safari ‚Üí –ü–æ–¥—ñ–ª–∏—Ç–∏—Å—è ‚Üí ¬´–î–æ–¥–∞—Ç–∏ –Ω–∞ –µ–∫—Ä–∞–Ω –î–æ–º—ñ–≤–∫–∏¬ª.',
            'Android: Chrome ‚Üí ¬´–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ –∑–∞—Å—Ç–æ—Å—É–Ω–æ–∫¬ª –∞–±–æ ¬´–î–æ–¥–∞—Ç–∏ –Ω–∞ –≥–æ–ª–æ–≤–Ω–∏–π –µ–∫—Ä–∞–Ω¬ª.',
            '–¢–∞–∫ —Ç—Ä–µ–Ω–∞–∂–µ—Ä –ø—Ä–∞—Ü—é—î —à–≤–∏–¥—à–µ —ñ –≤—ñ–¥–∫—Ä–∏–≤–∞—î—Ç—å—Å—è —è–∫ –æ–∫—Ä–µ–º–∏–π —Å–æ—Ñ—Ç, –∞ –Ω–µ –≤–∫–ª–∞–¥–∫–∞ –±—Ä–∞—É–∑–µ—Ä–∞.'
          ]
        },
        {
          h: '–û–Ω–æ–≤–ª–µ–Ω–Ω—è –∑–∞—Å—Ç–æ—Å—É–Ω–∫—É',
          p: [
            'MOYAMOVA –ø—ñ–¥—Ç—Ä–∏–º—É—î –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω—ñ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è.',
            '–î–ª—è —Ä—É—á–Ω–æ—ó –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ –≤—ñ–¥–∫—Ä–∏–π—Ç–µ –º–µ–Ω—é –π –Ω–∞—Ç–∏—Å–Ω—ñ—Ç—å ¬´–ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è¬ª.',
            '–Ø–∫—â–æ –¥–æ—Å—Ç—É–ø–Ω–∞ –Ω–æ–≤–∞ –≤–µ—Ä—Å—ñ—è, –∑–∞—Å—Ç–æ—Å—É–Ω–æ–∫ –∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç—å —ó—ó —Ç–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å—Å—è.',
            '–Ø–∫—â–æ –≤–µ—Ä—Å—ñ—è –≤–∂–µ –∞–∫—Ç—É–∞–ª—å–Ω–∞ ‚Äî –≤–∏ –ø–æ–±–∞—á–∏—Ç–µ –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–µ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è.'
          ]
        },
        {
          h: '–ú—ñ—Å—ñ—è –ø—Ä–æ—î–∫—Ç—É',
          p: [
            '–ú–∏ –ø—Ä–∞–≥–Ω–µ–º–æ –∑—Ä–æ–±–∏—Ç–∏ –≤–∏–≤—á–µ–Ω–Ω—è —Å–ª—ñ–≤ –ø—Ä–æ—Å—Ç–∏–º, —Å–ø–æ–∫—ñ–π–Ω–∏–º —Ç–∞ –µ—Ñ–µ–∫—Ç–∏–≤–Ω–∏–º: –±–µ–∑ —Ä–µ–∫–ª–∞–º–∏, –±–µ–∑ –∑–∞–π–≤–∏—Ö –≤—ñ–¥–≤–æ–ª—ñ–∫–∞–Ω—å ‚Äî —Ç—ñ–ª—å–∫–∏ –≤–∏, –º–æ–≤–∞ —ñ –ø—Ä–∞–∫—Ç–∏–∫–∞.'
          ]
        },
        {
          h: '–î—è–∫—É—î–º–æ, —â–æ –≤–∏ –∑ –Ω–∞–º–∏',
          p: [
            '–Ø–∫—â–æ MOYAMOVA –¥–æ–ø–æ–º–∞–≥–∞—î –≤–∞–º —É –Ω–∞–≤—á–∞–Ω–Ω—ñ, –≤–∏ –º–æ–∂–µ—Ç–µ –ø—ñ–¥—Ç—Ä–∏–º–∞—Ç–∏ —Ä–æ–∑–≤–∏—Ç–æ–∫ –ø—Ä–æ—î–∫—Ç—É —á–µ—Ä–µ–∑ –ø—É–Ω–∫—Ç ¬´–ü—ñ–¥—Ç—Ä–∏–º–∞—Ç–∏ –ø—Ä–æ—î–∫—Ç¬ª.',
            '–ë—É–¥—å-—è–∫–∞ –ø—ñ–¥—Ç—Ä–∏–º–∫–∞ ‚Äî —Ü–µ –≤–Ω–µ—Å–æ–∫ —É —Å–ª–æ–≤–Ω–∏–∫–∏, –Ω–æ–≤—ñ —Ñ—É–Ω–∫—Ü—ñ—ó –π —Ä–æ–∑–≤–∏—Ç–æ–∫ —Ç—Ä–µ–Ω–∞–∂–µ—Ä–∞ üíô'
          ]
        }
      ]
    };

    return currentLang() === 'uk' ? UK : RU;
  }

  // -------------------------
  // ROUTING
  // -------------------------
  function routeTo(name) {
    const target = name || 'home';
    try {
      if (root.Router && typeof root.Router.routeTo === 'function') {
        root.Router.routeTo(target);
      } else if (root.App && App.Router && typeof App.Router.routeTo === 'function') {
        App.Router.routeTo(target);
      }
    } catch (_) {}
  }

  // -------------------------
  // SHEET + STYLES
  // -------------------------
  function ensureSheet() {
    if (sheet) return;

    const css = `
      .guide-sheet{
        position:fixed;
        left:0; right:0;
        top:var(--header-h-actual);
        bottom:var(--footer-h-actual);
        z-index:1200;
        display:none;
        flex-direction:column;
        background:var(--surface-1, #ffffff);
        font-family:system-ui,-apple-system,"Segoe UI",Roboto,Arial,sans-serif;
      }
      .guide-top{
        display:flex;
        align-items:center;
        justify-content:flex-start;
        padding:10px 12px;
        border-bottom:1px solid var(--border, #e5e7eb);
      }
      .guide-title{
        font-weight:700;
        font-size:18px;
      }
      .guide-content{
        position:relative;
        flex:1 1 auto;
        overflow:auto;
        -webkit-overflow-scrolling:touch;
        padding:14px 12px 18px;
        color:var(--text, #111111);
      }
      .guide-root{
        max-width:640px;
        margin:0 auto;
        font-size:14px;
        line-height:1.6;
      }
      .guide-section + .guide-section{
        margin-top:14px;
      }
      .guide-heading{
        font-size:15px;
        font-weight:600;
        margin:0 0 6px;
      }
      .guide-text{
        margin:0 0 6px;
      }
      .guide-list{
        margin:4px 0 0;
        padding-left:18px;
      }
      .guide-list li{
        margin-bottom:4px;
      }
      body.guide-open{
        overflow:hidden;
      }
      @media (max-width:360px){
        .guide-content{ padding:10px 10px 14px; }
        .guide-title{ font-size:17px; }
      }
    `;

    styleTag = document.createElement('style');
    styleTag.id = 'guide-sheet-styles';
    styleTag.textContent = css;
    document.head.appendChild(styleTag);

    sheet = document.createElement('section');
    sheet.className = 'guide-sheet';
    sheet.setAttribute('role', 'dialog');
    sheet.style.display = 'none';

    const top = document.createElement('div');
    top.className = 'guide-top';
    top.innerHTML = '<div class="guide-title"></div>';

    scroller = document.createElement('div');
    scroller.className = 'guide-content';

    sheet.appendChild(top);
    sheet.appendChild(scroller);
    document.body.appendChild(sheet);

    // —Å–≤–∞–π–ø –≤–ø—Ä–∞–≤–æ ‚Äî –∑–∞–∫—Ä—ã—Ç–∏–µ
    sheet.addEventListener('touchstart', function (e) {
      if (e.touches.length !== 1) return;
      swX0 = e.touches[0].clientX;
      swY0 = e.touches[0].clientY;
      swMoved = false;
    }, { passive: true });

    sheet.addEventListener('touchmove', function (e) {
      if (e.touches.length !== 1) return;
      const dx = e.touches[0].clientX - swX0;
      const dy = e.touches[0].clientY - swY0;
      if (Math.abs(dx) > 6 || Math.abs(dy) > 6) swMoved = true;
    }, { passive: true });

    sheet.addEventListener('touchend', function (e) {
      if (!swMoved) return;
      const t = (e.changedTouches && e.changedTouches[0]) || (e.touches && e.touches[0]);
      if (!t) return;
      const dx = t.clientX - swX0;
      const dy = t.clientY - swY0;
      const ady = Math.abs(dy);
      const MIN_RIGHT = 80, MAX_UPDOWN = 48;
      if (dx > MIN_RIGHT && ady <= MAX_UPDOWN) {
        try { e.preventDefault(); } catch (_) {}
        close();
      }
    }, { passive: false });

    // Esc ‚Äî –∑–∞–∫—Ä—ã—Ç—å
    document.addEventListener('keydown', function (e) {
      if (!sheet || sheet.style.display === 'none') return;
      if (e.key === 'Escape' || e.key === 'Esc') {
        close();
      }
    }, { capture: true });

    // –µ—Å–ª–∏ —Å–º–µ–Ω–∏–ª–∏ —è–∑—ã–∫, –ø–æ–∫–∞ –ª–∏—Å—Ç –æ—Ç–∫—Ä—ã—Ç ‚Äî –ø–µ—Ä–µ—Ä–∏—Å—É–µ–º
    try {
      document.addEventListener('lexitron:ui-lang-changed', function () {
        if (!sheet || sheet.style.display === 'none') return;
        renderContent();
      });
    } catch (_) {}
  }

  // -------------------------
  // RENDER
  // -------------------------
  function renderContent() {
    if (!sheet || !scroller) return;
    const t = strings();

    const titleEl = sheet.querySelector('.guide-title');
    if (titleEl) titleEl.textContent = t.title;
    sheet.setAttribute('aria-label', t.title);

    let html = '<div class="guide-root">';
    t.blocks.forEach(block => {
      html += '<section class="guide-section">';
      if (block.h) {
        html += '<h2 class="guide-heading">' + block.h + '</h2>';
      }
      if (block.p && block.p.length) {
        block.p.forEach(text => {
          html += '<p class="guide-text">' + text + '</p>';
        });
      }
      if (block.ul && block.ul.length) {
        html += '<ul class="guide-list">';
        block.ul.forEach(item => {
          html += '<li>' + item + '</li>';
        });
        html += '</ul>';
      }
      html += '</section>';
    });
    html += '</div>';

    scroller.innerHTML = html;
    scroller.scrollTop = 0;
  }

  // -------------------------
  // OPEN / CLOSE
  // -------------------------
  function open() {
    ensureSheet();

    // –µ—Å–ª–∏ –æ—Ç–∫—Ä—ã—Ç –±—É—Ä–≥–µ—Ä ‚Äî –∑–∞–∫—Ä—ã–≤–∞–µ–º –µ–≥–æ (–∫–∞–∫ —É donate/legal)
    try {
      if (document.body.classList.contains('menu-open')) {
        document.body.classList.remove('menu-open');
        const ocRoot = document.querySelector('.oc-root');
        if (ocRoot) ocRoot.setAttribute('aria-hidden', 'true');
      }
    } catch (_) {}

    renderContent();
    sheet.style.display = 'flex';
    document.body.classList.add('guide-open');
  }

  function close() {
    if (!sheet) return;
    sheet.style.display = 'none';
    document.body.classList.remove('guide-open');
  }

  // -------------------------
  // FOOTER INTERCEPT
  // -------------------------
  document.addEventListener('click', function (e) {
    const btn = e.target.closest('.app-footer .nav-btn');
    if (!btn) return;
    if (!sheet || sheet.style.display === 'none') return;

    const target = btn.getAttribute('data-action');
    if (!target) return;

    e.preventDefault();
    e.stopPropagation();
    close();
    routeTo(target);
  }, true);

  // -------------------------
  // EXPORT
  // -------------------------
  root.Guide = {
    open: open,
    close: close
  };

})(window);
/* ========================= –ö–æ–Ω–µ—Ü —Ñ–∞–π–ª–∞: view.guide.js ========================= */
